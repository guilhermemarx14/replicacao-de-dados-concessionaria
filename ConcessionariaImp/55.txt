 INSERT INTO Troca SELECT * FROM ( SELECT  IDVenda, IDCompra FROM ( 	SELECT IDCompraVenda AS IDCompra, IDCliente, DATACOMPRAVENDA 		FROM COMPRAVENDA 		WHERE valorCompraVenda<0 AND TROCA) AS Compra INNER JOIN (		SELECT IDCompraVenda AS IDVenda, IDCliente,  DATACOMPRAVENDA 		FROM COMPRAVENDA 		WHERE valorCompraVenda>0 AND TROCA) AS Venda  ON (Compra.IDCliente = Venda.IDCliente AND Compra.DataCompravenda = Venda.DataCompravenda) ) AS Res ;